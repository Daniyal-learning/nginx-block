#!/bin/bash

# Prompt for the list of IPs
echo "Enter the list of IPs (one per line, double enter to end):"
ips=""
while IFS= read -r line; do
    if [ -z "$line" ]; then
        break
    fi
    ips+="deny $line;\n"
done < /dev/tty

# Server IP using myip command
server_ip=$(myip)

# Nginx configuration file path
nginx_conf_path="/etc/nginx/additional_server_conf"

# Append the IPs to the nginx configuration file
echo -e "$ips" | sudo tee -a "$nginx_conf_path" > /dev/null

# Reload nginx
sudo service nginx reload

# Display success message
echo "IPs added successfully. Nginx reloaded."
echo "Server IP: $server_ip"
